<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>anniversary</title>

  <link rel="stylesheet" href="css/anniversary.css" type="text/css"/>
  <script src="js/currency.js"></script>
  <script src="js/anniversary.js"></script>
  <script>
    function init() {
      const quitDate = AYESEEEM.anniversary.myQuitDate;
      const savingElement = document.getElementById('saving');

      function updateSaving() {
        const result = AYESEEEM.anniversary.celebrate(quitDate, new Date());
        const saving = result.saving;
        savingElement.innerHTML = saving;

        console.log('Summary:');
        result.summary.forEach(line => {
          console.log(line);
        });

        console.log('you have saved ' + saving + ' in today\'s prices');

        const celebrationsList = document.getElementById('celebrations');
        celebrationsList.innerHTML = '';
        result.celebrations.forEach(line => {
          const li = celebrationsList.appendChild(document.createElement('li'));
          li.textContent = line;
        });
      }

      document.getElementById('jsWarning').style.display = 'none';

      document.getElementById('quitDate').innerHTML = quitDate.toLocaleDateString();
      document.getElementById('quitTime').innerHTML = quitDate.toLocaleTimeString();

      updateSaving();
      setInterval(updateSaving, 5 * 1000);
    }

    document.addEventListener('DOMContentLoaded', init, false);
  </script>

</head>
<body>
  <h1>Anniversary</h1>
  <p id="jsWarning">This page only works if you have JavaScript enabled</p>
  <p>I gave up smoking on <span id="quitDate">(quit date)</span> at <span id="quitTime">(quit time)</span></p>
  <p>I have saved <span id="saving">(saving)</span> at today's prices</p>

  <h2>Celebrations</h2>
    <p>A (broken) Work In Progress - see
      <a href="https://github.com/ayeseeem/anniversary-js">the source</a>.
    </p>
  <ol id="celebrations">
  </ol>

  <h2><a href="https://en.wikipedia.org/wiki/Behind-the-scenes">BTS</a></h2>
  <p></p>
  <p><small>More <a href="./details.html">details</a>.</small></p>
</body>
</html>
